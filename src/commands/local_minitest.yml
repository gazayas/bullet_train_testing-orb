description: >
  Run the local minitest suite for the current package.
parameters:
  paralellism:
    type: integer
    default: 16
    description: "The amount of nodes we want to run in parallel when running tests."
  knapsackPro:
    type: boolean
    default: true
    description: "Determines whether we run the tests in parallel or linearly."

# TODO: Should this go in the executors directory?
# executor: ruby/default

steps:
  - checkout
  - run:
      environment:
        knapsackPro: <<parameters.knapsackPro>>
        parallelism: <<parameters.parallelism>> # TODO: Not sure if this will work here
        KNAPSACK_PRO_CI_NODE_TOTAL: <<parameters.parallelism>>
      name: Run local Minitest suite
      command: <<include(scripts/local_minitest.sh)>>
